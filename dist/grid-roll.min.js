!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("grid-roll",[],e):"object"==typeof exports?exports["grid-roll"]=e():t["grid-roll"]=e()}(window,function(){return n=[function(t,e){t.exports=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t},t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t){t.exports=JSON.parse('{"a":"1.4.1"}')},function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e){function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}t.exports=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t},t.exports.default=t.exports,t.exports.__esModule=!0},function(t,e,n){"use strict";n(1)},function(t,e,n){"use strict";n(2)},function(t,e,n){"use strict";n(3)},function(t,e,n){"use strict";n.r(e),n.d(e,"gridRoll",function(){return m}),n.d(e,"gridStart",function(){return x}),n.d(e,"gridPrize",function(){return y});var i=n(0),u=n.n(i),r=n(4),o=function(){var t=this,e=t.$createElement,e=t._self._c||e;return e("div",{staticClass:"gr"},[e("div",{ref:"container",staticClass:"gr-container"}),t._v(" "),e("div",{staticClass:"storag"},[t._t("button"),t._v(" "),t._t("prize")],2)])};o._withStripped=!0;var s=n(5),c=n.n(s),a=n(6),l=n.n(a),d=function(){function e(t){c()(this,e),this.indexs=this.setIndex(t),this.index=0}return l()(e,[{key:"indexValue",get:function(){if(!isNaN(Number(this.index)))return this.indexs[this.index]}},{key:"multi",get:function(){return 1<this.indexs.length&&this.index}},{key:"setIndex",value:function(t){return Array.isArray(t)?JSON.parse(JSON.stringify(t)):[t]}},{key:"next",value:function(){return this.indexs.length>++this.index}}]),e}();function f(e,t){var n,i=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)),i}i={name:"grid-roll",componentName:"grid-roll",props:{xy:{type:String,default:"3*3"},interval:{type:String,default:"0px"},startIndex:{validator:function(){return!0},default:0},direction:{type:String,default:"r"},circle:{type:Number,default:6},velocity:{type:Number,default:650},minVelocity:{type:[Number,Boolean],default:40},nextTimeInterval:{type:[Number],default:1e3}},data:function(){return{resolve:null,currentIndex:0,isPid:!1,$time:null,$watchStartIndex:null,$prizeComponents:[],$startComponent:null}},computed:{x:function(){return Number(this.xy.split("*")[0])},y:function(){return Number(this.xy.split("*")[1])},buttonxy:function(){return{maxX:this.x-2,maxY:this.y-2}},brim:function(){return"r"===this.direction?[{direction:"x",value:1},{direction:"y",value:1},{direction:"x",value:-1},{direction:"y",value:-1}]:[{direction:"y",value:1},{direction:"x",value:1},{direction:"y",value:-1},{direction:"x",value:-1}]},advances:function(){var n=this,i={x:0,y:0},r=0,o=this.brim[r],s=this[o.direction];return this.$prizeComponents.map(function(t,e){return 0!==e&&(i[o.direction]+=o.value),0===--s&&(r++,o=n.brim[r],s=n[o.direction]-1),function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach(function(t){u()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},i)})},sudokuArrayIndex:function(){var i=this;return this.$prizeComponents.map(function(t,e){var n=i.advances[e];return i.$prizeComponents.findIndex(function(t){return t.$options.x===n.x&&t.$options.y===n.y})})},changeNum:function(){return this.circle*this.$prizeComponents.length+1},currentDom:function(){return this.$prizeComponents[this.sudokuArrayIndex[this.currentIndex]]}},mounted:function(){this.$watch("xy",this.initDom,{immediate:!0})},beforeDestroy:function(){clearTimeout(this.$time)},methods:{startRoll:function(e){var n=this;return this.resolve?(this.$emit("underway",this.getId(this.currentIndex)),Promise.resolve(!1)):new Promise(function(t){n.forEachLamplight(),n.$params=new d(e),n.resolve=t,n.lamplight(!0),n.dischargeCargo()})},initDom:function(){var t=this;this.$nextTick(function(){t.filterDom(),t.setCoordinates(),t.setContainerSize(),"function"==typeof t.$watchStartIndex&&t.$watchStartIndex(),t.$watchStartIndex=t.$watch("startIndex",function(t){this.currentIndex=t},{immediate:!0})})},filterDom:function(){this.$prizeComponents=this.$children.filter(function(t){return"grid-prize"===t.$options.componentName}),this.$startComponent=this.$children.find(function(t){return"grid-start"===t.$options.componentName})},setCoordinates:function(){var e=this,n=0,i=0;this.$prizeComponents.forEach(function(t){e.isButtonInside(n,i)&&(n+=e.buttonxy.maxX),t.$options.x=n,t.$options.y=i,t.$el.style.left=e.getCalc("offsetWidth",n,n),t.$el.style.top=e.getCalc("offsetHeight",i,i),++n===e.x&&(n=0,i++)})},setContainerSize:function(){var t=this.getCalc("offsetWidth",this.x,this.x-1),e=this.getCalc("offsetHeight",this.y,this.y-1),n=this.$refs.container;n.style.width=t,n.style.height=e},getCalc:function(t,e,n){return"calc(".concat(this.$prizeComponents[0].$el[t]*e,"px + ").concat(this.interval," * ").concat(n,")")},isButtonInside:function(t,e){return!!this.$startComponent&&(0<t&&t<=this.buttonxy.maxX&&0<e&&e<=this.buttonxy.maxY)},getIsPid:function(){return this.$prizeComponents[0]&&void 0!==this.$prizeComponents[0].pid},stopRoll:function(){clearTimeout(this.$time)},continueRoll:function(){this.underway(this.changeNum,!1)},dischargeCargo:function(){var t=this;isNaN(Number(this.$params.indexValue))||(this.$params.multi?this.$time=setTimeout(function(){t.round()},this.nextTimeInterval):this.round())},round:function(){this.underway(this.countStep(this.$params.indexValue)-1)},countStep:function(t){t=this.getIsPid()?this.pIdToIndex(t):t;return this.changeNum+t-this.currentIndex},forEachLamplight:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this.$prizeComponents.forEach(function(t){t.setIsSelect(e)})},lamplight:function(){this.currentDom&&this.currentDom.setIsSelect(0<arguments.length&&void 0!==arguments[0]&&arguments[0])},underway:function(t){var e=this,n=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];if(clearTimeout(this.$time),t<=0)return this.$emit("select",this.$params.indexValue,this.$params.index),void this.reincarnation();if(n&&--t,this.indexsCompletion(this.currentIndex)||this.lamplight(),++this.currentIndex>this.$prizeComponents.length-1&&(this.currentIndex=0),void 0===this.currentDom)throw new TypeError("请确保宫格布局中奖品组件存在");this.currentDom.disabled?this.underway(t,n):(this.lamplight(!0),this.$time=setTimeout(function(){e.underway(t,n)},this.filterTime(t)))},reincarnation:function(){this.$params.next()?this.dischargeCargo():(this.resolve(!0),this.resolve=null)},indexsCompletion:function(){var t=this.$params.index;if(0<t){var e=this.indexExchangePrizeComponentPosition(this.currentIndex);return this.$params.indexs.slice(0,t).includes(e)}},filterTime:function(t){t=this.velocity/t;return t=this.minVelocity&&t<this.minVelocity?this.minVelocity:t},getId:function(t){return this.getIsPid()?this.sudokuArrayIndex[t]:t},pIdToIndex:function(e){var n=this.$prizeComponents.findIndex(function(t){return t.pid===e});return this.sudokuArrayIndex.findIndex(function(t){return t===n})},indexExchangePrizeComponentPosition:function(t){return this.getIsPid()?this.$prizeComponents[this.sudokuArrayIndex[t]].pid:t}}},n(7);function p(t,e,n,i,r,o,s,u){var c,a,l="function"==typeof t?t.options:t;return e&&(l.render=e,l.staticRenderFns=n,l._compiled=!0),i&&(l.functional=!0),o&&(l._scopeId="data-v-"+o),s?(c=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),r&&r.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(s)},l._ssrRegister=c):r&&(c=u?function(){r.call(this,(l.functional?this.parent:this).$root.$options.shadowRoot)}:r),c&&(l.functional?(l._injectStyles=c,a=l.render,l.render=function(t,e){return c.call(e),a(t,e)}):(u=l.beforeCreate,l.beforeCreate=u?[].concat(u,c):[c])),{exports:t,options:l}}s=p(i,o,[],!1,null,"6b94f2ce",null);s.options.__file="src/components/grid-roll/grid-roll.vue";a=s.exports,i=function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"gp-start"},[this._t("default")],2)};i._withStripped=!0;o={name:"grid-start",componentName:"grid-start"},n(8),s=p(o,i,[],!1,null,"3f904714",null);s.options.__file="src/components/grid-roll/grid-start.vue";o=s.exports,i=function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"gr-prize"},[this._t("default",null,{isSelect:this.isSelect})],2)};i._withStripped=!0;s={name:"grid-prize",componentName:"grid-prize",props:{disabled:Boolean,pid:{validator:function(){return!0}}},data:function(){return{isSelect:!1}},methods:{setIsSelect:function(t){this.isSelect=t}}},n(9),i=p(s,i,[],!1,null,"07ad7426",null);i.options.__file="src/components/grid-roll/grid-prize.vue";i={gridRoll:a,gridStart:o,gridPrize:i.exports};function h(e,t){var n,i=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)),i}e.default=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach(function(t){u()(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({version:r.a},i);var m=i.gridRoll,x=i.gridStart,y=i.gridPrize}],i={},r.m=n,r.c=i,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=10);function r(t){if(i[t])return i[t].exports;var e=i[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,r),e.l=!0,e.exports}var n,i});